<div class="driver-container">
  <!-- Header -->
  <div class="page-header">
    <div class="page-title">
      <div class="page-icon">üöó</div>
      <h1>Danh m·ª•c t√†i x·∫ø</h1>
    </div>
    <button class="btn-add" (click)="openAddModal()">
      <span>‚ûï</span>
      <span>Th√™m m·ªõi</span>
    </button>
  </div>

  <!-- Simple Filter -->
  <div class="simple-filter">
    <div class="search-box">
      <input type="text" class="search-input" id="searchInput"
        placeholder="üîç T√¨m ki·∫øm theo t√™n, s·ªë ƒëi·ªán tho·∫°i, b·∫±ng l√°i..." (input)="searchDriver($event)">
    </div>
    <select class="sort-select" id="sortSelect" (change)="sortData($event)">
      <option value="id-new">Ng√†y t·∫°o (m·ªõi nh·∫•t)</option>
      <option value="id-old">Ng√†y t·∫°o (c≈© nh·∫•t)</option>
      <option value="name-az">T√™n (A-Z)</option>`
      <option value="name-za">T√™n (Z-A)</option>
    </select>
    <select class="sort-select" id="entriesSelect" (change)="showEntries($event)">
      <option value="25">S·ªë l∆∞·ª£ng hi·ªÉn th·ªã 25</option>
      <option value="30">30</option>
      <option value="40">40</option>
      <option value="50">50</option>
    </select>
  </div>

  <!-- Table -->
  <div class="table-container">
    <table class="data-table">
      <thead>
        <tr>
          <th>ID</th>
          <th>T√™n t√†i x·∫ø</th>
          <th>Tr·∫°ng th√°i ho·∫°t ƒë·ªông</th>
          <th>M√£ b·∫±ng l√°i</th>
          <th>IsActive</th>
          <th>Thao t√°c</th>
        </tr>
      </thead>
      <tbody id="driverTableBody">
        <tr *ngFor="let driver of listDriver">
          <td>{{driver.driverID}}</td>
          <td>{{driver.driverName}}</td>
          <td *ngIf="driver.status == '0' ; else other_content">
            <span class="status-badge"  >
              üü¢ Available
            </span>
          </td>
          <ng-template #other_content>
            <td >
              <span class="status-badge"  >
                üî¥ Busy
              </span>
            </td>
          </ng-template>
          <td>{{driver.licenseNo}}</td>

          <td>
            <span class="status-badge" [class.active]="driver.status" [class.inactive]="!driver.status">
              {{driver.isActive}}
            </span>
          </td>
          <td>
            <div class="action-buttons">
              <button class="btn-action btn-edit" (click)="openDetailModal(driver.driverID)">Chi ti·∫øt</button>
              <button class="btn-action btn-delete" (click)="DeleteDriver(driver.driverID)">X√≥a</button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<!-- Modal Add -->
<div class="modal-overlay" [class.show]="isAddModalOpen" (click)="onOverlayClick($event, 'add')">
  <div class="modal-content">
    <div class="modal-header">
      <h2 class="modal-title" id="modalTitle">{{modalTitle}}</h2>
      <button class="modal-close" (click)="closeAddModal()">&times;</button>
    </div>
    <div class="modal-body">
      <form id="driverForm" (ngSubmit)="saveDriver()">
        <!-- Username -->
        <div class="form-group">
          <label class="form-label">
            T√™n ƒëƒÉng nh·∫≠p <span class="required">*</span>
          </label>
          <input type="text" class="form-input" id="userName" [(ngModel)]="driverForm.userName" name="userName"
            required>
        </div>

        <!-- Password -->
        <div class="form-group">
          <label class="form-label">
            M·∫≠t kh·∫©u <span class="required">*</span>
          </label>
          <input type="password" class="form-input" id="password" [(ngModel)]="driverForm.password" name="password"
            required>
        </div>

        <!-- Full Name -->
        <div class="form-group">
          <label class="form-label">
            H·ªç v√† t√™n ƒë·∫ßy ƒë·ªß <span class="required">*</span>
          </label>
          <input type="text" class="form-input" id="fullName" [(ngModel)]="driverForm.fullName" name="fullName"
            required>
        </div>

        <!-- Driver Name -->
        <div class="form-group">
          <label class="form-label">
            T√™n t√†i x·∫ø <span class="required">*</span>
          </label>
          <input type="text" class="form-input" id="driverName" [(ngModel)]="driverForm.driverName" name="driverName"
            required>
        </div>

        <!-- Address -->
        <div class="form-group">
          <label class="form-label">
            ƒê·ªãa ch·ªâ <span class="required">*</span>
          </label>
          <textarea class="form-input form-textarea" id="address" [(ngModel)]="driverForm.address" name="address"
            required></textarea>
        </div>

        <!-- Phone -->
        <div class="form-group">
          <label class="form-label">
            S·ªë ƒëi·ªán tho·∫°i <span class="required">*</span>
          </label>
          <input type="tel" class="form-input" id="phone" [(ngModel)]="driverForm.phone" name="phone" required>
        </div>

        <!-- License No -->
        <div class="form-group">
          <label class="form-label">
            S·ªë b·∫±ng l√°i <span class="required">*</span>
          </label>
          <input type="text" class="form-input" id="licenseNo" [(ngModel)]="driverForm.licenseNo" name="licenseNo"
            required>
        </div>

        <!-- Expire Date -->
        <div class="form-group">
          <label class="form-label">
            Ng√†y h·∫øt h·∫°n b·∫±ng l√°i <span class="required">*</span>
          </label>
          <input type="date" class="form-input" id="expireDate" [(ngModel)]="driverForm.expireDate" name="expireDate"
            required>
        </div>

        <div class="form-actions">
          <button type="button" class="btn-cancel" (click)="closeAddModal()">H·ªßy</button>
          <button type="submit" class="btn-save">{{isEditMode ? 'C·∫≠p nh·∫≠t' : 'L∆∞u'}}</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Modal Chi ti·∫øt -->
<div class="modal-overlay" [class.show]="isDetailModalOpen" (click)="onOverlayClick($event, 'detail')">
  <div class="modal-content">
    <div class="modal-header">
      <h2 class="modal-title">Chi ti·∫øt t√†i x·∫ø</h2>
      <button class="modal-close" (click)="closeDetailModal()">&times;</button>
    </div>
    <div class="modal-body" *ngIf="currentDriver; else loadingTemplate">
      <form id="detailDriverForm">
        <!-- ID t√†i x·∫ø - READ ONLY -->
        <div class="form-group">
          <label class="form-label">ID t√†i x·∫ø:</label>
          <input type="text" class="form-input readonly" [(ngModel)]="currentDriver.driverID" name="driverID" readonly>
        </div>
        <div class="form-group">
          <label class="form-label">T√™n ƒëƒÉng nh·∫≠p:</label>
          <input type="text" class="form-input readonly" [(ngModel)]="currentDriver.user.userName" name="userName"
            readonly>
        </div>
        <!-- Username - C√ì TH·ªÇ EDIT -->
        <div class="form-group">
          <label class="form-label">
            M·∫≠t kh·∫©u *( Ctrl + Z ƒë·ªÉ ho√†n l·∫°i m·∫≠t kh·∫©u ban ƒë·∫ßu)<span class="required">*</span>
          </label>
          <input type="text" class="form-input" [(ngModel)]="currentDriver.user.password" name="password" required>
        </div>



        <!-- Driver Name - C√ì TH·ªÇ EDIT -->
        <div class="form-group">
          <label class="form-label">
            T√™n t√†i x·∫ø <span class="required">*</span>
          </label>
          <input type="text" class="form-input" [(ngModel)]="currentDriver.driverName" name="driverName" required>
        </div>

        <!-- Address - C√ì TH·ªÇ EDIT -->
        <div class="form-group">
          <label class="form-label">
            ƒê·ªãa ch·ªâ <span class="required">*</span>
          </label>
          <textarea class="form-input form-textarea" [(ngModel)]="currentDriver.address" name="address"
            required></textarea>
        </div>

        <!-- Phone - C√ì TH·ªÇ EDIT -->
        <div class="form-group">
          <label class="form-label">
            S·ªë ƒëi·ªán tho·∫°i <span class="required">*</span>
          </label>
          <input type="tel" class="form-input" [(ngModel)]="currentDriver.phone" name="phone" required>
        </div>

        <!-- License No - C√ì TH·ªÇ EDIT -->
        <div class="form-group">
          <label class="form-label">
            S·ªë b·∫±ng l√°i <span class="required">*</span>
          </label>
          <input type="text" class="form-input" [(ngModel)]="currentDriver.licenseNo" name="licenseNo" required>
        </div>

        <!-- Expire Date - C√ì TH·ªÇ EDIT -->
        <div class="form-group">
          <label class="form-label">
            Ng√†y h·∫øt h·∫°n b·∫±ng l√°i <span class="required">*</span>
          </label>
          <input type="date" class="form-input" [(ngModel)]="currentDriver.expireDate" name="expireDate" required>
        </div>

        <!-- Status - C√ì TH·ªÇ EDIT -->
        <div class="form-group">
          <label class="form-label">
            Tr·∫°ng th√°i
          </label>
          <select class="form-input" [(ngModel)]="currentDriver.status" name="status">
            <!-- <option *ngIf="currentDriver.status == '0'" value="Available" disabled>üü¢ S·∫µn s√†ng nh·∫≠n ƒë∆°n</option>
            <option *ngIf="currentDriver.status == '1'" value="Busy" disabled>üî¥ ƒêang b·∫≠n giao h√†ng</option> -->
            <option value="Available" >üü¢ S·∫µn s√†ng nh·∫≠n ƒë∆°n</option>
            <option value="Busy">üî¥ ƒêang b·∫≠n giao h√†ng</option>
          </select>
        </div>


        <!--IsActive - C√ì TH·ªÇ EDIT -->
        <div class="form-group">
          <label class="form-label">
            Tr·∫°ng th√°i ho·∫°t ƒë·ªông t·∫°i c√¥ng ty
          </label>
          <select class="form-input" [(ngModel)]="currentDriver.isActive" name="isActive">
            <option value="true">‚úÖ ƒêang l√†m vi·ªác</option>
            <option value="false">‚ùå ƒê√£ ngh·ªâ vi·ªác</option>
          </select>
        </div>

      </form>
    </div>

    <!-- Loading template -->
    <ng-template #loadingTemplate>
      <div class="modal-body loading-container">
        <div class="loading"></div>
        <p>ƒêang t·∫£i th√¥ng tin...</p>
      </div>
    </ng-template>

    <div class="modal-footer" *ngIf="currentDriver">
      <button type="button" class="btn-secondary" (click)="closeDetailModal()">ƒê√≥ng</button>
      <button type="button" class="btn-primary" (click)="updateDriverFromDetail(currentDriver.driverID)">C·∫≠p
        nh·∫≠t</button>
    </div>
  </div>
</div>

<div class="pagination-container pagination-fade-in">
  <!-- Info Text -->
  <div class="pagination-info">
    T·ªïng <strong>1-10</strong> c·ªßa <strong>156</strong> k·∫øt qu·∫£
  </div>

  <!-- Pagination Controls -->
  <div class="pagination-controls">
    <!-- Previous Button -->
    <button class="pagination-btn nav-btn prev" [disabled]="pageNumber === 1" (click)="changePage(pageNumber - 1)">
      <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
        <path fill-rule="evenodd"
          d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z"
          clip-rule="evenodd" />
      </svg>
      Tr∆∞·ªõc
    </button>

    <!-- Page Numbers -->
    <button class="pagination-btn" [class.active]="pageNumber === 1" (click)="changePage(1)">1</button>
    <button class="pagination-btn" [class.active]="pageNumber === 2" (click)="changePage(2)">2</button>
    <button class="pagination-btn" [class.active]="pageNumber === 3" (click)="changePage(3)">3</button>
    <button class="pagination-btn mobile-hidden" [class.active]="pageNumber === 4" (click)="changePage(4)">4</button>
    <button class="pagination-btn mobile-hidden" [class.active]="pageNumber === 5" (click)="changePage(5)">5</button>

    <!-- Ellipsis -->
    <span class="pagination-ellipsis mobile-hidden">...</span>

    <!-- Last Page -->
    <button class="pagination-btn mobile-hidden" [class.active]="pageNumber === 16" (click)="changePage(16)">16</button>

    <!-- Next Button -->
    <button class="pagination-btn nav-btn next" [disabled]="pageNumber === 16" (click)="changePage(pageNumber + 1)">
      Sau
      <svg width="16" height="16" fill="currentColor" viewBox="0 0 20 20">
        <path fill-rule="evenodd"
          d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"
          clip-rule="evenodd" />
      </svg>
    </button>
  </div>
</div>


