<div class="customer-container">
        <!-- Header -->
        <div class="page-header">
            <div class="page-title">
                <div class="page-icon">üîß</div>
                <h1>Danh m·ª•c B·∫£o d∆∞·ª°ng</h1>
            </div>
            <button class="btn-add" (click)="openAddModal()">
                <span>‚ûï</span>
                <span>Th√™m m·ªõi</span>
            </button>
        </div>

        <!-- Filter -->
        <div class="simple-filter">
            <div class="search-box">
                <input type="text" class="search-input" placeholder="üîç T√¨m ki·∫øm theo ID, ng∆∞·ªùi th·ª±c hi·ªán" (input)="searchObject($event)">
            </div>
            <div class="filter-group">
                <label>T·ª´ ng√†y</label>
                <input type="date" class="filter-input" [(ngModel)]="fromDateStr" (change)="FilterDate()">
            </div>
            <div class="filter-group">
                <label>ƒê·∫øn ng√†y</label>
                <input type="date" class="filter-input" [(ngModel)]="toDateStr" (change)="FilterDate()">
            </div>
            <div class="filter-group">
                <label>S·∫Øp x·∫øp</label>
                <select class="sort-select" (change)="sortData($event)">
                    <option value="id-old">Ng√†y t·∫°o (c≈© nh·∫•t)</option>
                    <option value="id-new">Ng√†y t·∫°o (m·ªõi nh·∫•t)</option>
                    <option value="name-az">Gi√° tƒÉng d·∫ßn </option>
                    <option value="name-za">Gi√° gi·∫£m d·∫ßn </option>
                </select>
            </div>
            <div class="filter-group">
                <label>Hi·ªÉn th·ªã</label>
                <select class="sort-select" (change)="showEntries($event)">
                    <option value="30">30 m·ª•c</option>
                    <option value="35">35 m·ª•c</option>
                    <option value="40">40 m·ª•c</option>
                    <option value="50">50 m·ª•c</option>
                </select>
            </div>
        </div>

        <!-- Table -->
        <div class="table-container">
            <table class="data-table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>S·ªë xe</th>
                        <th>H·∫°ng m·ª•c b·∫£o d∆∞·ª°ng</th>
                        <th>Ng∆∞·ªùi th·ª±c hi·ªán</th>
                        <th>Ng√†y th·ª±c hi·ªán</th>
                        <th>Chi ph√≠</th>
                        <th>Thao t√°c</th>
                    </tr>
                </thead>
                <tbody *ngIf="listmaintenance.length > 0">
                    <tr *ngFor="let l of listmaintenance">
                        <td>{{l.maintenanceID}}</td>
                        <td>{{l.truckNo}}</td>
                        <td>{{l.maintenanceTypeName}}</td>
                        <td>{{l.implementedBy}}</td>
                        <td>{{l.scheduledDate | stringDateFormatPipe:'dd/MM/yyyy'}}</td>
                        <td>{{ l.cost | number:'1.0-0' }}ƒë</td>
                        <td>
                            <div class="action-buttons">
                                <button class="btn-action btn-edit" (click)="openDetailModal(l.maintenanceID)">Chi ti·∫øt</button>
                                <button class="btn-action btn-delete" (click)="Delete(l.maintenanceID)">X√≥a</button>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Pagination -->
        <div class="pagination-container">
            <div class="pagination-info">
                Hi·ªÉn th·ªã <strong>{{lengthItem}} ƒë∆°n b·∫£o d∆∞·ª°ng </strong> trong trang <strong></strong>
            </div>
            <div class="pagination-controls">
                <button class="pagination-btn" [disabled]="pageNumber === 1" (click)="changePage(pageNumber - 1)">Tr∆∞·ªõc</button>
                <button class="pagination-btn" [class.active]="pageNumber === 1" (click)="changePage(1)">1</button>
                <button class="pagination-btn" [class.active]="pageNumber === 2" (click)="changePage(2)">2</button>
                <button class="pagination-btn" [class.active]="pageNumber === 3" (click)="changePage(3)">3</button>
                <button class="pagination-btn" [class.active]="pageNumber === 4" (click)="changePage(4)">4</button>
                <button class="pagination-btn" [class.active]="pageNumber === 5" (click)="changePage(5)">5</button>
                <span style="padding: 0 8px; color: #999;">...</span>
                <button class="pagination-btn" [class.active]="pageNumber === 16" (click)="changePage(16)">10</button>
                <button class="pagination-btn" [disabled]="pageNumber === 16" (click)="changePage(pageNumber + 1)">Sau</button>
            </div>
        </div>
    </div>

    <!-- Modal Add/Edit -->
    <div class="modal-overlay" [class.show]="isAddModalOpen" (click)="onOverlayClick($event, 'add')">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">{{modalTitle}}</h2>
                <button class="modal-close" (click)="closeAddModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form (ngSubmit)="save()">
                    <div class="form-group">
                        <label class="form-label">
                            Ng√†y b·∫£o d∆∞·ª°ng <span class="required">*</span>
                        </label>
                        <input type="date" class="form-input" [(ngModel)]="MaintenanceForm.ScheduledDate" name="ScheduledDate" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label">S·ªë xe <span class="required">*</span></label>
                        <div class="custom-select-wrapper">
                            <div class="custom-select-trigger" [class.active]="showTruckDropdown" (click)="toggleDropdown('truck')">
                                <span class="custom-select-value">{{getSelectedTruckNo() || 'Ch·ªçn s·ªë xe'}}</span>
                                <span class="custom-select-arrow">‚ñº</span>
                            </div>
                            <div class="custom-select-dropdown" [class.show]="showTruckDropdown">
                                <div class="custom-select-search">
                                    <input type="text" placeholder="üîç T√¨m ki·∫øm s·ªë xe..." [(ngModel)]="truckSearchTerm" [ngModelOptions]="{standalone: true}" (input)="filterTrucks()">
                                </div>
                                <div class="custom-select-options">
                                    <div class="custom-select-option" 
                                         *ngFor="let truck of filteredTrucks"
                                         [class.selected]="MaintenanceForm.TruckID === truck.truckID"
                                         (click)="selectTruck(truck)">
                                        {{truck.truckNo}}
                                    </div>
                                    <div class="custom-select-option no-results" *ngIf="filteredTrucks.length === 0">
                                        üîç Kh√¥ng t√¨m th·∫•y k·∫øt qu·∫£
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">H·∫°ng m·ª•c b·∫£o d∆∞·ª°ng <span class="required">*</span></label>
                        <div class="custom-select-wrapper">
                            <div class="custom-select-trigger" [class.active]="showMaintenanceTypeDropdown" (click)="toggleDropdown('maintenanceType')">
                                <span class="custom-select-value">{{getSelectedMaintenanceTypeName() || 'Ch·ªçn h·∫°ng m·ª•c'}}</span>
                                <span class="custom-select-arrow">‚ñº</span>
                            </div>
                            <div class="custom-select-dropdown" [class.show]="showMaintenanceTypeDropdown">
                                <div class="custom-select-search">
                                    <input type="text" placeholder="üîç T√¨m ki·∫øm h·∫°ng m·ª•c..." [(ngModel)]="maintenanceTypeSearchTerm" [ngModelOptions]="{standalone: true}" (input)="filterMaintenanceTypes()">
                                </div>
                                <div class="custom-select-options">
                                    <div class="custom-select-option" 
                                         *ngFor="let type of filteredMaintenanceTypes"
                                         [class.selected]="MaintenanceForm.MaintenanceTypeID === type.maintenanceTypeID"
                                         (click)="selectMaintenanceType(type)">
                                        {{type.nameType}}
                                    </div>
                                    <div class="custom-select-option no-results" *ngIf="filteredMaintenanceTypes.length === 0">
                                        üîç Kh√¥ng t√¨m th·∫•y k·∫øt qu·∫£
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">
                            ƒê∆°n v·ªã thi c√¥ng <span class="required">*</span>
                        </label>
                        <input type="text" class="form-input" placeholder="Nh·∫≠p t√™n ƒë∆°n v·ªã thi c√¥ng" [(ngModel)]="MaintenanceForm.ImplementedBy" name="ImplementedBy" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label">
                            Chi ti·∫øt ph·ª• t√πng (M√¥ t·∫£)
                        </label>
                        <textarea class="form-input form-textarea" placeholder="Nh·∫≠p m√¥ t·∫£ chi ti·∫øt..." [(ngModel)]="MaintenanceForm.Description" name="Description"></textarea>
                    </div>

                    <div class="form-group">
                        <label class="form-label">
                            Chi ph√≠ <span class="required">*</span>
                        </label>
                        <input type="number" class="form-input" placeholder="Nh·∫≠p chi ph√≠" [(ngModel)]="MaintenanceForm.Cost" name="Cost" required>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="btn-cancel" (click)="closeAddModal()">H·ªßy</button>
                        <button type="submit" class="btn-save">{{isEditMode ? 'C·∫≠p nh·∫≠t' : 'L∆∞u'}}</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal Detail -->
    <div class="modal-overlay" [class.show]="isDetailModalOpen" (click)="onOverlayClick($event, 'detail')">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Chi ti·∫øt b·∫£o d∆∞·ª°ng</h2>
                <button class="modal-close" (click)="closeDetailModal()">&times;</button>
            </div>
            <div class="modal-body" *ngIf="currentMaintenance">
                <form>
                    <div class="form-group">
                        <label class="form-label">M√£ ƒë∆°n b·∫£o d∆∞·ª°ng</label>
                        <input type="text" class="form-input readonly" [(ngModel)]="currentMaintenance.maintenanceID" name="MaintenanceID" readonly>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Ng√†y th·ª±c hi·ªán <span class="required">*</span></label>
                        <input type="date" class="form-input" [(ngModel)]="currentMaintenance.scheduledDate" name="scheduledDate">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Bi·ªÉn s·ªë xe</label>
                        <div class="custom-select-wrapper">
                            <div class="custom-select-trigger" [class.active]="showTruckDropdownDetail" (click)="toggleDropdown('truckDetail')">
                                <span class="custom-select-value">{{getSelectedTruckNoDetail() || 'Ch·ªçn s·ªë xe'}}</span>
                                <span class="custom-select-arrow">‚ñº</span>
                            </div>
                            <div class="custom-select-dropdown" [class.show]="showTruckDropdownDetail">
                                <div class="custom-select-search">
                                    <input type="text" placeholder="üîç T√¨m ki·∫øm s·ªë xe..." [(ngModel)]="truckSearchTermDetail" [ngModelOptions]="{standalone: true}" (input)="filterTrucksDetail()">
                                </div>
                                <div class="custom-select-options">
                                    <div class="custom-select-option" 
                                         *ngFor="let truck of filteredTrucksDetail"
                                         [class.selected]="currentMaintenance.truckID === truck.truckID"
                                         (click)="selectTruckDetail(truck)">
                                        {{truck.truckNo}}
                                    </div>
                                    <div class="custom-select-option no-results" *ngIf="filteredTrucksDetail.length === 0">
                                        üîç Kh√¥ng t√¨m th·∫•y k·∫øt qu·∫£
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">H·∫°ng m·ª•c b·∫£o d∆∞·ª°ng</label>
                        <div class="custom-select-wrapper">
                            <div class="custom-select-trigger" [class.active]="showMaintenanceTypeDropdownDetail" (click)="toggleDropdown('maintenanceTypeDetail')">
                                <span class="custom-select-value">{{getSelectedMaintenanceTypeNameDetail() || 'Ch·ªçn h·∫°ng m·ª•c'}}</span>
                                <span class="custom-select-arrow">‚ñº</span>
                            </div>
                            <div class="custom-select-dropdown" [class.show]="showMaintenanceTypeDropdownDetail">
                                <div class="custom-select-search">
                                    <input type="text" placeholder="üîç T√¨m ki·∫øm h·∫°ng m·ª•c..." [(ngModel)]="maintenanceTypeSearchTermDetail" [ngModelOptions]="{standalone: true}" (input)="filterMaintenanceTypesDetail()">
                                </div>
                                <div class="custom-select-options">
                                    <div class="custom-select-option" 
                                         *ngFor="let type of filteredMaintenanceTypesDetail"
                                         [class.selected]="currentMaintenance.maintenanceTypeID === type.maintenanceTypeID"
                                         (click)="selectMaintenanceTypeDetail(type)">
                                        {{type.nameType}}
                                    </div>
                                    <div class="custom-select-option no-results" *ngIf="filteredMaintenanceTypesDetail.length === 0">
                                        üîç Kh√¥ng t√¨m th·∫•y k·∫øt qu·∫£
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Ng∆∞·ªùi t·∫°o ƒë∆°n</label>
                        <input type="text" class="form-input readonly" [(ngModel)]="currentMaintenance.userName" name="userName" readonly>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Chi ph√≠ <span class="required">*</span></label>
                        <input type="number" class="form-input" [(ngModel)]="currentMaintenance.cost" name="cost" [readonly]="roleName != 'Admin'">
                    </div>

                    <div class="form-group">
                        <label class="form-label">ƒê∆°n v·ªã th·ª±c hi·ªán <span class="required">*</span></label>
                        <input type="text" class="form-input" [(ngModel)]="currentMaintenance.implementedBy" name="implementedBy">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Chi ti·∫øt ph·ª• t√πng (M√¥ t·∫£)</label>
                        <textarea class="form-input form-textarea" [(ngModel)]="currentMaintenance.description" name="description"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer" *ngIf="currentMaintenance">
                <button type="button" class="btn-secondary" (click)="closeDetailModal()">ƒê√≥ng</button>
                <button type="button" class="btn-primary" (click)="updateMaintenance(currentMaintenance.maintenanceID)">C·∫≠p nh·∫≠t</button>
            </div>
        </div>
    </div>