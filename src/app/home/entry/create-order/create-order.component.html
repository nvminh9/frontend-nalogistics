<div class="main-content">
    <div class="content-card update-form-section">
        <div class="card-header">
            <h2>
                <span class="icon">‚úèÔ∏è</span>
                T·∫°o m·ªõi ƒë∆°n h√†ng
            </h2>
            <div class="subtitle">T·∫°o chi ti·∫øt ƒë∆°n h√†ng v·∫≠n chuy·ªÉn</div>
        </div>

        <div class="form-container">
            <div class="form-grid">
                <!-- Ng√†y giao h√†ng  -->
                <div class="form-group">
                    <label>Ng√†y giao h√†ng</label>
                    <input type="date" id="datePicker" name="orderDate" class="form-input" [(ngModel)]="currentOrderDTO.OrderDate" >
                </div>

                <!-- Kh√°ch h√†ng - Searchable Dropdown -->
                <div class="form-group">
                    <label>Kh√°ch h√†ng</label>
                    <div class="searchable-dropdown" id="customerDropdown">
                        <div class="dropdown-toggle" (click)="showListObject('customerDropdown')">
                            <span class="selected-text">{{ currentOrderDTO.CustomerName || 'Ch·ªçn kh√°ch h√†ng'}}</span>
                            <span class="dropdown-arrow">‚ñº</span>
                        </div>
                        <div class="dropdown-menu">
                            <input type="text" class="dropdown-search" placeholder="T√¨m ki·∫øm kh√°ch h√†ng..." 
                                   (input)="toggleDropdown('customerDropdown', $event)">
                                   
                            <ul *ngIf="listCustomerDTO.length > 0" class="dropdown-list">
                                <li *ngFor="let c of listCustomerDTO" 
                                    class="dropdown-item"
                                    (click)="onSelectCustomer(c.customerID)">
                                    {{c.customerName}}
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>S·ªë Container</label>
                    <input type="text" class="form-input" placeholder="S·ªë container" name="ContainerNo" [(ngModel)]="currentOrderDTO.ContainerNo">
                </div>

                <div class="form-group">
                    <label>Lo·∫°i Container</label>
                    <select class="form-select" name="ContainerType" [(ngModel)]="currentOrderDTO.ContainerType">
                        <option value="20 feet">20 feet</option>
                        <option value="30 feet">30 feet</option>
                        <option value="40 feet">40 feet</option>
                        <option value="45 feet">45 feet</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>S·ªë Bill/Booking</label>
                    <input type="text" class="form-input" placeholder="S·ªë Bill/Booking" name="BillBookingNo" [(ngModel)]="currentOrderDTO.BillBookingNo">
                </div>
                
                <!-- C·∫£ng nh·∫≠n Container - Searchable Dropdown -->
                <div class="form-group">
                    <label>C·∫£ng nh·∫≠n Container</label>
                    <div class="searchable-dropdown" id="portReceiveDropdown">
                        <div class="dropdown-toggle" (click)="showListObject('portReceiveDropdown')">
                            <span class="selected-text">{{currentOrderDTO.FromLocationName || 'Ch·ªçn c·∫£ng nh·∫≠n'}}</span>
                            <span class="dropdown-arrow">‚ñº</span>
                        </div>
                        <div class="dropdown-menu">
                            <input type="text" class="dropdown-search" placeholder="T√¨m ki·∫øm c·∫£ng nh·∫≠n..." 
                                   (input)="toggleDropdown('portReceiveDropdown', $event)">
                            <ul *ngIf="listLocationDTO.length > 0" class="dropdown-list">
                                <li *ngFor="let l of listLocationDTO" 
                                    class="dropdown-item"
                                    (click)="onSelectLocation(l.locationId,'FromLocationID')">
                                    {{l.locationName}}
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Kho nh·∫≠n/giao h√†ng - Searchable Dropdown -->
                <div class="form-group">
                    <label>Kho nh·∫≠n/giao h√†ng</label>
                    <div class="searchable-dropdown" id="warehouseDropdown">
                        <div class="dropdown-toggle" (click)="showListObject('warehouseDropdown')">
                            <span class="selected-text">{{currentOrderDTO.FromWhereName || 'Ch·ªçn kho'}}</span>
                            <span class="dropdown-arrow">‚ñº</span>
                        </div>
                        <div class="dropdown-menu">
                            <input type="text" class="dropdown-search" placeholder="T√¨m ki·∫øm kho..." 
                                   (input)="toggleDropdown('warehouseDropdown', $event)">
                            <ul *ngIf="listLocationDTO.length > 0" class="dropdown-list">
                                <li *ngFor="let l of listLocationDTO" 
                                    class="dropdown-item"
                                    (click)="onSelectLocation(l.locationId,'FromWhereID')">
                                    {{l.locationName}}
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- C·∫£ng h·∫°/tr·∫£ Container - Searchable Dropdown -->
                <div class="form-group">
                    <label>C·∫£ng h·∫°/tr·∫£ Container</label>
                    <div class="searchable-dropdown" id="portReturnDropdown">
                        <div class="dropdown-toggle" (click)="showListObject('portReturnDropdown')">
                            <span class="selected-text">{{currentOrderDTO.ToLocationName || 'Ch·ªçn c·∫£ng h·∫°'}}</span>
                            <span class="dropdown-arrow">‚ñº</span>
                        </div>
                        <div class="dropdown-menu">
                            <input type="search" class="dropdown-search" placeholder="T√¨m ki·∫øm c·∫£ng h·∫°..." 
                                   (input)="toggleDropdown('portReturnDropdown', $event)">
                            
                            <ul *ngIf="listLocationDTO.length > 0" class="dropdown-list">
                                <li *ngFor="let l of listLocationDTO" 
                                    class="dropdown-item"
                                    (click)="onSelectLocation(l.locationId,'ToLocationID')">
                                    {{l.locationName}}
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                <!-- //////// -->

                <!-- T√†i x·∫ø - Searchable Dropdown -->
                <!-- <div class="form-group">
                    <label>T√†i x·∫ø</label>
                    <div class="searchable-dropdown" id="driverDropdown">
                        <div class="dropdown-toggle" (click)="showListObject('driverDropdown')">
                            <span class="selected-text"> {{ currentOrderDTO.driverName || 'Ch·ªçn t√†i x·∫ø' }} </span>
                            <span class="dropdown-arrow">‚ñº</span>
                        </div>
                        <div class="dropdown-menu">
                            <input type="text" class="dropdown-search" placeholder="T√¨m ki·∫øm t√†i x·∫ø..." 
                                   (input)="toggleDropdown('driverDropdown', $event)">
                            <ul *ngIf="listDriverDTO.length > 0" class="dropdown-list">
                                <li *ngFor="let d of listDriverDTO" 
                                    class="dropdown-item"
                                    (click)="onSelectDriver(d.driverID)">
                                    {{d.driverName}}
                                </li>
                            </ul>
                        </div>
                    </div>
                </div> -->

                <!-- S·ªë xe - Searchable Dropdown -->
                <!-- <div class="form-group">
                    <label>S·ªë xe</label>
                    <div class="searchable-dropdown" id="vehicleDropdown">
                        <div class="dropdown-toggle" (click)="showListObject('vehicleDropdown')">
                            <span class="selected-text">{{currentOrderDTO.TruckNo || 'Ch·ªçn s·ªë xe' }}</span>
                            <span class="dropdown-arrow">‚ñº</span>
                        </div>
                        <div class="dropdown-menu">
                            <input type="text" class="dropdown-search" placeholder="T√¨m ki·∫øm s·ªë xe..." 
                                   (input)="toggleDropdown('vehicleDropdown', $event)">
                            <ul *ngIf="listTruckDTO.length > 0" class="dropdown-list">
                                <li *ngFor="let t of listTruckDTO" 
                                    class="dropdown-item"
                                    (click)="onSelectTruck(t.truckID)">
                                    {{t.truckNo}}
                                </li>
                            </ul>
                        </div>
                    </div>
                </div> -->

                <!-- S·ªë Rmooc - Searchable Dropdown -->
                <!-- <div class="form-group">
                    <label>S·ªë Rmooc</label>
                    <div class="searchable-dropdown" id="rmoorDropdown">
                        <div class="dropdown-toggle" (click)="showListObject('rmoorDropdown')">
                            <span class="selected-text">{{currentOrderDTO.RmoocNo || 'Ch·ªçn Rmooc'}}</span>
                            <span class="dropdown-arrow">‚ñº</span>
                        </div>
                        <div class="dropdown-menu">
                            <input type="text" class="dropdown-search" placeholder="T√¨m ki·∫øm Rmooc..." 
                                   (input)="toggleDropdown('rmoorDropdown', $event)">
                            <ul *ngIf="listRmoocDTO.length > 0" class="dropdown-list">
                                <li *ngFor="let r of listRmoocDTO" 
                                    class="dropdown-item"
                                    (click)="onSelectRmooc(r.truckID)">
                                    {{r.truckNo}}
                                </li>
                            </ul>
                        </div>
                    </div>
                </div> -->

            </div>

            <!-- Ph·∫ßn danh m·ª•c chi ph√≠ -->
            <div class="expense-section" *ngIf="rolename == '' ">
                <div class="expense-header">
                    <span class="icon">üí∞</span>
                    <h3>Danh m·ª•c chi ph√≠</h3>
                </div>
                
                <table class="expense-table">
                    <thead>
                        <tr>
                            <th>Danh m·ª•c chi ph√≠</th>
                            <th>Gi√° ti·ªÅn g·ªëc</th>
                            <th>Gi√° hi·ªán t·∫°i</th>
                            <th>C√≥ h√≥a ƒë∆°n?</th>
                            <th>S·ªë h√≥a ƒë∆°n</th>
                            <th>T√™n h√≥a ƒë∆°n</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let line of currentOrderDTO.OrderLineList; let idx = index "  >
                            <input type="hidden" [(ngModel)]="line.ItemID" name="ItemID{{idx}}" >
                            <td><input type="text" [value]="line.ItemName" readonly></td>
                            <td><input type="text" [value]="line.fixedPrice | number:'1.0-0':'en-US'" readonly></td>
                            <td><input type="number" placeholder="0" [(ngModel)]="line.ItemCost" name="ItemCost{{idx}}"></td>
                            <td>
                                <input type="checkbox" id="invoice1" [(ngModel)]="line.hasInvoice" name="hasInvoice{{idx}}">
                                <label for="invoice1" style="margin-left: 8px;">C√≥</label>
                            </td>
                            <td><input type="text" placeholder="S·ªë h√≥a ƒë∆°n"  [(ngModel)]="line.InvoiceNo" name="InvoiceNo{{idx}}"></td>
                            <td><input type="text" placeholder="T√™n h√≥a ƒë∆°n" [(ngModel)]="line.InvoiceName" name="InvoiceName{{idx}}"></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="form-actions">
                <button type="button" (click)="cancelOrder()" class="btn-cancel">H·ªßy b·ªè</button>
                <button type="button" class="btn-save" (click)="saveOrder()">L∆∞u ƒë∆°n h√†ng</button>
            </div>
        </div>
    </div>
</div>